# hns-migrator

(hive ns 迁移工具) Hive NameService Migrator

## Scripts

The `scripts` directory contains small utilities used during HDFS
namespace migrations.

### `get_table_location.sh`
Query Hive for the location of a table using `spark-sql --master local`.

```bash
./scripts/get_table_location.sh <database.table>
```

### `show_hdfs_owners.sh`
Display the owner and group for every level of a given HDFS path and
record the information to `hdfs_owners.log` in the `scripts` directory.

```bash
./scripts/show_hdfs_owners.sh <hdfs-path>
```

The output file contains lines of the form `path owner group` which can be
used by other utilities.

### `get_table_info.sh`
Convenience wrapper that combines the above steps and prints the table
location and ownership information.

```bash
./scripts/get_table_info.sh <database.table>
```

Each script exits with an error message if required arguments are not
provided.

### `verify_paths.sh`
Read the `hdfs_owners.log` file generated by `show_hdfs_owners.sh`, replace
`DClusterUS1` with the specified cluster name and output the `hadoop` commands
needed to create and set ownership for each missing path (up to the second to
last level).

```bash
./scripts/verify_paths.sh <new-cluster>
```
